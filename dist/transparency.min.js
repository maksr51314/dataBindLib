"use strict";(function(){var B={},q={},i,h,k,A,j={},p,a={},n,o,t,s,m,y,w,l,f,e,d,c,v,g,b,x,r,u,z;B.toString=Object.prototype.toString;B.toArray=function(E){var D,C=new Array(E.length);for(D=0;D<E.length;D++){C[D]=E[D]}return C};B.isString=function(C){return B.toString.call(C)==="[object String]"};B.isNumber=function(C){return B.toString.call(C)==="[object Number]"};B.isArray=Array.isArray||function(C){return B.toString.call(C)==="[object Array]"};B.isDate=function(C){return B.toString.call(C)==="[object Date]"};B.isElement=function(C){return !!(C&&C.nodeType===1)};B.isPlainValue=function(D){var C;C=typeof D;return(C!=="object"&&C!=="function")||B.isDate(D)};B.isBoolean=function(C){return C===true||C===false};q.ELEMENT_NODE=1;q.TEXT_NODE=3;q.before=function(C){return function(D){return function(){C.apply(this,arguments);return D.apply(this,arguments)}}};q.after=function(C){return function(D){return function(){D.apply(this,arguments);return C.apply(this,arguments)}}};q.chainable=q.after(function(){return this});q.getElements=function(C){var D=[];k(C,D);return D};k=function(D,E){var F,C;F=D.firstChild;C=[];while(F){if(F.nodeType===q.ELEMENT_NODE){E.push(new a.createElement(F));k(F,E)}C.push(F=F.nextSibling)}return C};h=function(){return document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>"};q.cloneNode=(function(){if((document===undefined||document===null)||h()){return function(C){return C.cloneNode(true)}}else{return function(F){var C,E,H,D,G;C=j.clone(F);if(C.nodeType===q.ELEMENT_NODE){C.removeAttribute(i);G=C.getElementsByTagName("*");for(H=0,D=G.length;H<D;H++){E=G[H];E.removeAttribute(i)}}return C}}})();i="transparency";q.data=function(C){return C[i]||(C[i]={})};A=function(F,E){var D;for(D in E){if(E.hasOwnProperty(D)){F[D]=E[D]}}function C(){this.constructor=F}C.prototype=E.prototype;F.prototype=new C();F.__super__=E.prototype;return F};j.render=function(D,G,F,C){var E;if(!G){G=[]}if(!F){F={}}if(!C){C={}}console.log("Transparency.render:",D,G,F,C);if(!D){return}if(!B.isArray(G)){G=[G]}D=(E=q.data(D)).context||(E.context=new p(D,j));return D.render(G,F,C).el};j.matcher=function(D,C){return D.el.id===C||[].indexOf.call(D.classNames,C)>=0||D.el.name===C||D.el.getAttribute("data-bind")===C};if(typeof jQuery!=="undefined"&&jQuery!==null){if(jQuery){jQuery.fn.render=q.chainable(function(I,H,E){var F,G,D,C;C=[];for(G=0,D=this.length;G<D;G++){F=this[G];C.push(j.render(F,I,H,E))}return C})}}if(typeof window!=="undefined"&&window!==null){window.Transparency=j}p=(function(){var D,E;E=q.chainable(function(){this.parent=this.el.parentNode;if(this.parent){this.nextSibling=this.el.nextSibling;return this.parent.removeChild(this.el)}});D=q.chainable(function(){if(this.parent){if(this.nextSibling){return this.parent.insertBefore(this.el,this.nextSibling)}else{return this.parent.appendChild(this.el)}}});function C(G,F){this.el=G;this.Transparency=F;this.template=q.cloneNode(this.el);this.instances=[new z(this.el,this.Transparency)];this.instanceCache=[]}C.prototype.render=q.before(E)(q.after(D)(q.chainable(function(F,I,O){var G,L,N,K,J,M,H;while(F.length<this.instances.length){this.instanceCache.push(this.instances.pop().remove())}while(F.length>this.instances.length){N=this.instanceCache.pop()||new z(q.cloneNode(this.template),this.Transparency);this.instances.push(N.appendTo(this.el))}H=[];for(L=J=0,M=F.length;J<M;L=++J){K=F[L];N=this.instances[L];G=[];H.push(N.prepare(K,G).renderValues(K,G).renderDirectives(K,L,I).renderChildren(K,G,I,O))}return H})));return C})();a={Elements:{input:{}},createElement:function(D){var E,C;if("input"===(C=D.nodeName.toLowerCase())){E=a.Elements[C][D.type.toLowerCase()]||t}else{E=a.Elements[C]||o}return new E(D)}};o=(function(){function C(D){this.el=D;this.attributes={};this.childNodes=B.toArray(this.el.childNodes);this.nodeName=this.el.nodeName.toLowerCase();this.classNames=this.el.className.split(" ")}C.prototype.empty=function(){var D;while(D=this.el.firstChild){this.el.removeChild(D)}return this};C.prototype.reset=function(){var F,E,G,D;G=this.attributes;D=[];for(E in G){F=G[E];D.push(F.set(F.templateValue))}return D};C.prototype.render=function(D){return this.attr("text",D)};C.prototype.attr=function(D,G){var F,E;F=(E=this.attributes)[D]||(E[D]=v.createAttribute(this.el,D,G));if(G!=null){F.set(G)}return F};C.prototype.renderDirectives=function(H,G,E){var J,F,I,D;D=[];for(F in E){if(!E.hasOwnProperty(F)){continue}J=E[F];if(!(typeof J==="function")){continue}I=J.call(H,{element:this.el,index:G,value:this.attr(F).templateValue});if(I!=null){D.push(this.attr(F,I))}else{D.push(void 0)}}return D};return C})();m=(function(C){A(D,C);a.Elements.select=D;function D(E){D.__super__.constructor.call(this,E);this.elements=q.getElements(E)}D.prototype.render=function(J){var G,I,F,H,E;J=J.toString();H=this.elements;E=[];for(I=0,F=H.length;I<F;I++){G=H[I];if(G.nodeName==="option"){E.push(G.attr("selected",G.el.value===J))}}return E};return D})(o);w=(function(E){var H,G,F,C;A(D,E);function D(){l=D.__super__.constructor.apply(this,arguments);return l}H=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];for(F=0,C=H.length;F<C;F++){G=H[F];a.Elements[G]=D}D.prototype.attr=function(I,J){if(I!=="text"&&I!=="html"){return D.__super__.attr.call(this,I,J)}};return D})(o);t=(function(C){A(D,C);function D(){f=D.__super__.constructor.apply(this,arguments);return f}D.prototype.render=function(E){return this.attr("value",E)};return D})(w);y=(function(C){A(D,C);function D(){e=D.__super__.constructor.apply(this,arguments);return e}a.Elements.textarea=D;return D})(t);n=(function(C){A(D,C);function D(){d=D.__super__.constructor.apply(this,arguments);return d}a.Elements.input["checkbox"]=D;D.prototype.render=function(E){return this.attr("checked",Boolean(E))};return D})(t);s=(function(C){A(D,C);function D(){c=D.__super__.constructor.apply(this,arguments);return c}a.Elements.input["radio"]=D;return D})(n);z=(function(){function C(E,D){this.Transparency=D;this.queryCache={};this.childNodes=B.toArray(E.childNodes);this.elements=q.getElements(E)}C.prototype.remove=q.chainable(function(){var F,H,E,G,D;G=this.childNodes;D=[];for(H=0,E=G.length;H<E;H++){F=G[H];D.push(F.parentNode.removeChild(F))}return D});C.prototype.appendTo=q.chainable(function(F){var G,I,E,H,D;H=this.childNodes;D=[];for(I=0,E=H.length;I<E;I++){G=H[I];D.push(F.appendChild(G))}return D});C.prototype.prepare=q.chainable(function(F){var G,I,E,H,D;H=this.elements;D=[];for(I=0,E=H.length;I<E;I++){G=H[I];G.reset();D.push(q.data(G.el).model=F)}return D});C.prototype.renderValues=q.chainable(function(E,H){var G,F,I,D;if(B.isElement(E)&&(G=this.elements[0])){return G.empty().el.appendChild(E)}else{if(typeof E==="object"){D=[];for(F in E){if(!E.hasOwnProperty(F)){continue}I=E[F];if(I!=null){if(B.isString(I)||B.isNumber(I)||B.isBoolean(I)||B.isDate(I)){D.push((function(){var M,J,L,K;L=this.matchingElements(F);K=[];for(M=0,J=L.length;M<J;M++){G=L[M];K.push(G.render(I))}return K}).call(this))}else{if(typeof I==="object"){D.push(H.push(F))}else{D.push(void 0)}}}}return D}}});C.prototype.renderDirectives=q.chainable(function(G,F,J){var E,I,H,D;D=[];for(H in J){if(!J.hasOwnProperty(H)){continue}E=J[H];if(!(typeof E==="object")){continue}if(typeof G!=="object"){G={value:G}}D.push((function(){var N,K,M,L;M=this.matchingElements(H);L=[];for(N=0,K=M.length;N<K;N++){I=M[N];L.push(I.renderDirectives(G,F,E))}return L}).call(this))}return D});C.prototype.renderChildren=q.chainable(function(I,D,F,L){var H,K,G,J,E;E=[];for(G=0,J=D.length;G<J;G++){K=D[G];E.push((function(){var O,M,P,N;P=this.matchingElements(K);N=[];for(O=0,M=P.length;O<M;O++){H=P[O];N.push(this.Transparency.render(H.el,I[K],F[K],L))}return N}).call(this))}return E});C.prototype.matchingElements=function(D){var F,G,E;G=(E=this.queryCache)[D]||(E[D]=(function(){var K,I,J,H;J=this.elements;H=[];for(K=0,I=J.length;K<I;K++){F=J[K];if(this.Transparency.matcher(F,D)){H.push(F)}}return H}).call(this));console.log("Matching elements for '"+D+"':",G);return G};return C})();v={Attributes:{},createAttribute:function(D,C){var E;E=v.Attributes[C]||g;return new E(D,C)}};g=(function(){function C(E,D){this.el=E;this.name=D;this.templateValue=this.el.getAttribute(this.name)||""}C.prototype.set=function(D){this.el[this.name]=D;return this.el.setAttribute(this.name,D.toString())};return C})();b=(function(F){var H,E,G,D;A(C,F);H=["hidden","async","defer","autofocus","formnovalidate","disabled","autofocus","formnovalidate","multiple","readonly","required","checked","scoped","reversed","selected","loop","muted","autoplay","controls","seamless","default","ismap","novalidate","open","typemustmatch","truespeed"];for(G=0,D=H.length;G<D;G++){E=H[G];v.Attributes[E]=C}function C(J,I){this.el=J;this.name=I;this.templateValue=this.el.getAttribute(this.name)||false}C.prototype.set=function(I){this.el[this.name]=I;if(I){return this.el.setAttribute(this.name,this.name)}else{return this.el.removeAttribute(this.name)}};return C})(g);u=(function(D){A(C,D);v.Attributes.text=C;function C(F,E){var G;this.el=F;this.name=E;this.templateValue=((function(){var K,I,J,H;J=this.el.childNodes;H=[];for(K=0,I=J.length;K<I;K++){G=J[K];if(G.nodeType===q.TEXT_NODE){H.push(G.nodeValue)}}return H}).call(this)).join("");this.children=B.toArray(this.el.children);if(!(this.textNode=this.el.firstChild)){this.el.appendChild(this.textNode=this.el.ownerDocument.createTextNode(""))}else{if(this.textNode.nodeType!==q.TEXT_NODE){this.textNode=this.el.insertBefore(this.el.ownerDocument.createTextNode(""),this.textNode)}}}C.prototype.set=function(I){var J,H,F,G,E;while(J=this.el.firstChild){this.el.removeChild(J)}this.textNode.nodeValue=I;this.el.appendChild(this.textNode);G=this.children;E=[];for(H=0,F=G.length;H<F;H++){J=G[H];E.push(this.el.appendChild(J))}return E};return C})(g);r=(function(D){A(C,D);v.Attributes.html=C;function C(E){this.el=E;this.templateValue="";this.children=B.toArray(this.el.children)}C.prototype.set=function(G){var J,I,F,H,E;while(J=this.el.firstChild){this.el.removeChild(J)}this.el.innerHTML=G+this.templateValue;H=this.children;E=[];for(I=0,F=H.length;I<F;I++){J=H[I];E.push(this.el.appendChild(J))}return E};return C})(g);x=(function(D){A(C,D);v.Attributes["class"]=C;function C(E){C.__super__.constructor.call(this,E,"class")}return C})(g)})();